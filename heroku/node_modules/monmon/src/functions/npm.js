const { MessageEmbed } = require('discord.js')
async function npm(message, args, options = {}) {
    if (!message) throw new Error('MonMon Err: "message" is not defined')
    if (!args) throw new Error('MonMon Err: "args" is not defined')
    
    const package = args.join(" ")
    if(!package) return message.reply('Give me a package name to search')
		
    const axios = require('axios')
    const body = await axios.get(`https://api.tovade.xyz/v1/info/npm?package=${package}`)
    const res = body.data

    const embed = new MessageEmbed()
	.setTitle(options.embedTitle || 'NPM Search')
    .setColor(options.embedColor || 'ff0000')
    .setURL(`https://npmjs.org/${package}`)
    .setDescription(`Info from the NPM package ${package}`)
    .addField('Name:', `${package}`, inline = true)
    .addField('Developers:', `${res.maintainers}`, inline = true)
    .addField('Version:', `\`${res.version}\``, inline = true)
    .addField('License:', `\`${res.license}\``, inline = true)
    .addField('Created:', `\`${res.createdAt}\``, inline = true)
    .addField('Last Modified:', `\`${res.last_modify}\``, inline = true)
    .addField('Repository:', `${res.repository}`, inline = true)
    .addField('Description:', `${res.description}`, inline = true)
 message.channel.send({embeds: [embed]})
    
}

module.exports = npm;
